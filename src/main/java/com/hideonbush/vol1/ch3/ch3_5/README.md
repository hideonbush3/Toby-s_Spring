# 템플릿 콜백 패턴
전략 패턴에 익명 내부 클래스 구조를 활용한 방식을 스프링에서는 템플릿/콜백 패턴이라고 한다.

전략 패턴의 컨텍스트를 템플릿이라 부르고 익명 내부 클래스로 만들어지는 오브젝트를 콜백이라고 부른다.

## 템플릿?
프로그래밍 관점에서 템플릿이란 고정된 틀 안에 바뀔 수 있는 부분을 넣어서 사용하는 것을 말한다.

템플릿 메서드 패턴도 고정된 틀을 갖춘 로직을 가진 템플릿 메서드를 슈퍼 클래스에 두고
바뀌는 부분을 서브 클래스의 메서드에 두는 구조이다.

## 콜백?
실행되는 것을 목적으로 다른 오브젝트의 메서드로 전달되는 오브젝트를 말한다.
메서드의 파라미터로 메서드를 전달할 수 없기 때문에 실행시킬 메서드를 담은 오브젝트, 즉 콜백을 전달한다.

## 템플릿 콜백 패턴의 특징
여러개의 메서드를 담는 일반적인 인터페이스를 사용할 수 있는 전략 패턴과 달리
템플릿 콜백 패턴에서는 보통 함수형 인터페이스를 사용한다.

콜백 인터페이스의 메서드에는 보통 파라미터가 있으며 이 파라미터는 템플릿의 작업 도중 생성되는 컨텍스트 정보를 전달받을 때 사용된다.

## 템플릿 콜백 작업흐름
1. 클라이언트가 콜백을 만들고 만든 콜백을 전달하며 템플릿의 메서드를 호출한다.
2. 템플릿은 틀에 정해진 작업을 진행하다가 내부에서 생성한 참조정보를 전달하며 콜백의 메서드를 호출한다.
3. 콜백은 필요에따라 클라이언트 메서드에 있는 정보와 템플릿에서 전달받은 참조정보를 사용해 작업을 진행하고 결과값을 템플릿에 돌려준다.
4. 템플릿은 남은 작업을 처리하고 작업을 끝마친다. 필요에 따라 클라이언트로 결과를 반환한다.

예제를 바탕으로,
템플릿이 내부에서 생성한 참조정보란 DB 커넥션 객체가 될 것이고,
콜백이 사용하는 클라이언트 메서드에 있는 정보란 add()의 User 객체가 될 것이다.

클라이언트가 콜백을 만들고 이것을 템플릿에 전달하는것은 메서드 레벨에서 일어나는 DI이다.

일반적인 DI라면 템플릿에 인스턴스 변수를 만들어두고 사용할 의존 오브젝트를 수정자 메서드로 받아서 사용할 것이다.
반면, 템플릿 콜백 방식에서는 매번 메서드 단위로 사용할 오브젝트를 새롭게 전달받는다는 것이 특징이다.

콜백 메서드가 자신을 생성해준 클라이언트 메서드 내의 정보를 직접 참조하는것도 템플릿 콜백 방식의 고유한 특징이다.

## 결론
템플릿 콜백 패턴은 전략 패턴과 DI의 장점을 익명 내부 클래스 사용 전략과 결합한 독특한 활용법이다.